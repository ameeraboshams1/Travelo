<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Travelo · Blog</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/css/blogs.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <meta name="description" content="Travelo blog: guides, tips, and stories to travel smarter."/>
</head>
<body>

  
  <header class="topbar">
    <div class="container topbar-row">
      <a class="brand" href="../index.html">
        <img src="./assets/images/logo.svg" alt="Travelo" class="logo" />
        <span>Travelo</span>
      </a>
      <nav class="actions">
        <a class="chip" href="./index.php">Back To Home</a>
        <a class="chip" href="./support.html">Support</a>
      </nav>
    </div>
    <div class="glow"></div>
  </header>

  <main class="container">
    <section class="hero">
      <h1>Travelo Blog</h1>
      <p class="muted">Guides, deals, and travel wisdom from the Travelo team.</p>

      <div class="controls">
        <div class="search-wrap">
          <input id="searchInput" type="search" placeholder="Search articles… (e.g., baggage, visa, Europe)"/>
          <button id="clearSearch" class="ghost" title="Clear">✕</button>
        </div>
        <div class="tags" id="tagStrip">
                  </div>
      </div>
    </section>

    <section id="grid" class="grid" aria-live="polite"></section>

    <div class="pager" id="pager"></div>
  </main>
    
  <footer class="site-footer">
    <div class="container">
      <p>© <span id="year"></span> Travelo. All rights reserved.</p>
    </div>
  </footer>
  <script src="./assets/js/blogs.js"></script>

  <button id="askAiBtn" class="ask-ai-btn" type="button" aria-label="Ask AI">
  <i class="bi bi-airplane-fill" aria-hidden="true"></i>
  <span class="ask-ai-bubble">Ask AI</span>
</button>


<script>
(() => {
  const AGENT_ID = "019b189a507c7f0e98a0580ad136880f79ad";
  const SRC = `https://cdn.jotfor.ms/agent/embedjs/${AGENT_ID}/embed.js`;

  function loadWidget(){
    return new Promise((resolve, reject) => {
      // لو محمّل قبل لا تعيديه
      if (document.querySelector(`script[src="${SRC}"]`)) return resolve();

      const s = document.createElement("script");
      s.src = SRC;
      s.async = true;
      s.onload = resolve;
      s.onerror = () => reject(new Error("Failed to load widget"));
      document.body.appendChild(s);
    });
  }

  function openLauncherWhenReady(timeoutMs = 8000){
    return new Promise((resolve) => {
      const start = Date.now();

      const tryOpen = () => {
        // لانشر Jotform (جربي عدة سلكترات)
        const launcher =
          document.querySelector('button[aria-label*="Ask AI" i]') ||
          document.querySelector('button[aria-label*="Chat" i]') ||
          document.querySelector('[data-testid*="launcher" i]') ||
          document.querySelector('.jotform-ai-launcher, .agent-launcher, .chat-launcher');

        if (launcher) { launcher.click(); resolve(true); return true; }

        if (Date.now() - start > timeoutMs) { resolve(false); return true; }
        return false;
      };

      if (tryOpen()) return;

      const obs = new MutationObserver(() => {
        if (tryOpen()) obs.disconnect();
      });
      obs.observe(document.documentElement, { childList:true, subtree:true });
    });
  }

  document.addEventListener("DOMContentLoaded", () => {
    const btn = document.getElementById("askAiBtn");
    if (!btn) return;

    btn.addEventListener("click", async () => {
      // ✅ اخفي زرّك فورًا بعد أول كبسة
      btn.style.display = "none";

      try{
        await loadWidget();           // ✅ حمّلي الشات بوت الآن (كان مخفي قبل)
        await openLauncherWhenReady(); // ✅ افتحيه تلقائيًا
      }catch(e){
        console.error(e);
        // لو صار خطأ، رجّعي الزر حتى ما يختفي على الفاضي
        btn.style.display = "";
        alert("AI widget failed to load.");
      }
    }, { once:true }); // ✅ يمنع تعدد الكبس/تكرار
  });
})();
</script>
</body>
</html>
